<!DOCTYPE html>
<html>
<head>
<title th:text="#{view.index.title}">Welcome!</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link href="../../../resources/css/bootstrap.min.css" rel="stylesheet"
	media="screen" th:href="@{/resources/css/bootstrap.min.css}" />
<link href="../../../resources/css/core.css" rel="stylesheet"
	media="screen" th:href="@{/resources/css/core.css}" />
<script src="http://code.jquery.com/jquery-latest.js"></script>
<script src="../../../resources/js/bootstrap.min.js"
	th:src="@{/resources/js/bootstrap.min.js}"></script>
	
<script type="text/javascript">
function togglePin(_pinID) {
    $.ajax({
      url: 'togglePin',
      type: 'POST',
      data: ({pinID : _pinID}),
      success: function(data) {
      	$("td#value_"+_pinID).text(data);
        if(data == true){
        	$("button#"+_pinID).attr("class", "btn btn-danger").text("Wyłącz");
        }
        else {
        	$("button#"+_pinID).attr("class", "btn btn-success").text("Włącz");
        }
      }
    });
  }
</script>
</head>
<body>
	<div th:replace="fragments/header :: header">&nbsp;</div>
	<div class="container">
		<!-- /* Handle the flash message */-->
		<th:block th:if="${message != null}">
			<!-- /* The message code is returned from the @Controller */ -->
			<div
				th:replace="fragments/alert :: alert (type=success, message=${message})">&nbsp;</div>
		</th:block>
		<table class="table table-striped">
			<tr>
				<th>Nazwa pinu</th>
				<th>Adres</th>
				<th>Otwarty</th>
				<th>Kierunek</th>
				<th>Wartość</th>
				<th>Akcja</th>
			</tr>

			<tr th:each="pin: ${pins}">
				<td th:text="${pin.pinID}"></td>
				<td th:text="${pin.address}"></td>
				<td th:text="${pin.open}"></td>
				<td th:text="${pin.direction}"></td>
				<td th:text="${pin.value}"></td>
				<td th:id="value_+${pin.pinID}" th:text="${pin.value}"></td>
				<td th:switch="${pin.value}" width="90px">
				<button th:case="true" class="btn btn-danger" th:id="${pin.pinID}" onclick="togglePin(this.id)">Wyłącz</button>
				<button th:case="false" class="btn btn-success" th:id="${pin.pinID}" onclick="togglePin(this.id)">Włącz</button>									
				<!--   <form action="leds" th:action="@{/leds}" th:object="${ledsToggleForm}" method="post">
							<input type="hidden" id="pinID" name="pinID"
								th:object="${ledsToggleForm.pinID}" th:value="" /> <input
								type="hidden" id="pinValue" name="pinValue"
								th:object="${ledsToggleForm.pinID}" th:value="true" /> <input
								class="btn btn-success" type="submit" value="Włącz" />
					</form>-->
				</td>
			</tr>
		</table>
	</div>
</body>
</html>
